


<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title></title>
    <link rel="shortcut icon" href="https://cdn.dusays.com/favicon.ico">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/grid.css">
    <script src="/js/app.js"></script>
    <script src="/js/srjs.js"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    
        <meta name="keywords" content="">
        
    
        <meta name="keywords" content="杜老师说,老师,讲师,运维,博客,技术,微软,思科,红帽,服务,软件,图文,视频,单词,求职,面试,网站,搭建,网络,教程,说课,资">
        
    
    <script>
        main.load.js('/pandown@2.0.0', function () {
            pandown();
        });
    </script>
    <meta name="follow.it-verification-code" content="LlmddNY7dr0ZbV24UdUh"/>
    <meta name="360-site-verification" content="6e6223d4a72a81e520e67080db00fda6"/>
    <meta name="baidu-site-verification" content="codeva-Oz6pd5JcaV"/>
</head>
<body>

<div class="loading_page"><div class="loading_i center"></div><style>*{transition:none}.loading_i{visibility:visible}body{visibility:hidden}</style></div>
<header class="header card bg-blue" id="header">
    <div class="blog-logo">
        <a href="" class="logo">杜老师说</a>
    </div>
    <nav class="navbar">
        <ul class="menu">
            
                <li class="menu-item">
                    
                        <a href="" class="menu-item-link"></a>
                    
                        <a href="" class="menu-item-link" aria-label="" title=""></a>
                    
                </li>
            
            <li class="menu-item">
                <a href="javascript:main.dark.change()" class="menu-item-link" aria-label="暗色模式" title="暗色模式"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-moon-fill" viewBox="0 0 16 16">
  <path d="M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278"/>
</svg></a>
            </li>
        </ul>
    </nav>
</header>
<div class="msg" id="msg">
</div>
<main class="main w-full grid page-main no-side">
    


<article class="cm9 c9 p9 m12 block-input">
    
    <div class="card main">
        <div class="func-btns"><button title="进入阅读器" class="btn bg-clear" onclick="main.plugins.read()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-book" viewBox="0 0 16 16">
  <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"></path>
</svg></button></div>
        <div class="title"><h1>PHP最佳实践（译）</h1></div>
        <div class="info">
            <div class="metas">
                
                    <span class="meta"></span>
                
            </div>
            <hr style="border-color: #ddd">
        </div>
        <div class="content" id="page">
            
                
            
            <hr />
<p>author: ''<br />
categories: 新闻<br />
comments_data: []<br />
count:<br />
commentnum: 0<br />
favtimes: 0<br />
likes: 0<br />
sharetimes: 0<br />
viewnum: 3955<br />
date: '2013-09-20 11:59:00'<br />
editorchoice: false<br />
excerpt: &quot;神马？又一个Linux漏洞？非也非也。其他操作系统可能很容易被恶意软件盯上，但是Linux对抗恶意软件依然坚挺。\r\n\r\n作者： Steven<br />
J.Vaughan-Nichols\r\n起初，HoT(Hand of Thief 盗贼之手)木马看起来将会成为第一个真正意  ...&quot;<br />
fromurl: ''<br />
id: 1979<br />
islctt: false<br />
largepic: /data/attachment/album/201309/19/183818aafm0qenk0qllxph.png<br />
url: /article-1979-1.html<br />
pic: /data/attachment/album/201309/19/183818aafm0qenk0qllxph.png.thumb.jpg<br />
related: []<br />
reviewer: ''<br />
selector: ''<br />
summary: &quot;神马？又一个Linux漏洞？非也非也。其他操作系统可能很容易被恶意软件盯上，但是Linux对抗恶意软件依然坚挺。\r\n\r\n作者： Steven<br />
J.Vaughan-Nichols\r\n起初，HoT(Hand of Thief 盗贼之手)木马看起来将会成为第一个真正意  ...&quot;<br />
tags:</p>
<ul>
<li>银行木马</li>
<li>恶意软件</li>
<li>Fedora<br />
thumb: false<br />
title: Linux &quot;HoT&quot;银行木马：失败的恶意软件<br />
titlepic: false<br />
translator: ''<br />
updated: '2013-09-20 11:59:00'</li>
</ul>
<hr />
<blockquote>
<p><em>神马？又一个Linux漏洞？非也非也。其他操作系统可能很容易被恶意软件盯上，但是Linux对抗恶意软件依然坚挺。</em></p>
</blockquote>
<p>作者： Steven J.Vaughan-Nichols</p>
<p>起初，<a href="http://www.zdnet.com/linux-desktop-trojan-hand-of-thief-steals-in-7000019175/">HoT(Hand of Thief 盗贼之手)木马看起来将会成为第一个真正意义上成功的Linux木马</a>。但是EMC的安全部门RSA进一步研究发现，HoT木马其实只是“所谓”的Linux恶意软件而已，打个比方，就是叫的响，很少咬人。</p>
<p><img src="/data/attachment/album/201309/19/183818aafm0qenk0qllxph.png" alt="" /></p>
<p>Hand of Thief：又一个失败的Linux恶意软件程序。(来源：RSA)</p>
<p>是的！唯一因为这个“所谓”的木马而受伤害的也只有那些肯花2000美元去购买这款木马的“黑客”自己。</p>
<p>来自RSA的一位高级安全研究员Yotam Gottesman报告说，他们已经获取到了HoT的源代码并生成了可执行文件，发现<a href="https://blogs.rsa.com/rsa-peeks-into-the-bits-of-new-linux-based-trojan-hand-of-thief/">HoT并没有什么实际功能</a>。“我们的研究分析表明，实际上HoT的窃取能力非常有限，只相当于一个恶意软件的雏形，如果要将它作为一个商用的银行木马还需要做非常多的工作”。</p>
<p>我个人“体验”了一下HoT，感觉就好像我闻到烟味了，但其实并没有着火。它只是利用了Chrome浏览器已有补丁的一个问题。</p>
<p>HoT的生成器(builder——实际用来生成木马的部分)是一个windows程序。理论上，生成器可以产生HoT的新变体，即32位的<a href="http://www.thegeekstuff.com/2012/07/elf-object-file-format/">ELF</a>程序。ELF是Linux上的标准二进制格式。</p>
<p>一旦被安装，HoT就会从Web表单抓取信息，并将其发送到僵尸网络服务器。但是，作为恶意软件，HoT失败在最基本的地方，因为他需要用户批准才能安装。</p>
<p>在一些诸如Windows的操作系统中，在用户不知情的情况下，系统很容易感染恶意软件。而在其他系统中，例如<a href="http://www.zdnet.com/five-simple-ways-to-avoid-android-malware-7000017463">Android，系统如果要安装程序则必须经过用户同意才行</a>。至于Linux，普通用户想要正常安装程序更需要使出浑身解数。针对这些现状，HoT并未能够为网络犯罪提供某种机制使入侵Linux变得简单。</p>
<p>事实上，即使你真的被HoT感染了一台Linux个人电脑，它仍然几乎啥也干不了。RSA发现HoT在<a href="http://fedoraproject.org/">Fedora</a>的firefox上常常崩溃，对 Fedora上的Chrome 常常抓取到无用的数据，而在<a href="http://www.ubuntu.com/">Ubuntu Linux</a>上它根本不能运行。</p>
<p>所以，RSA得出结论，“HoT只是赶上了网络黑市中商业木马需求量飙高的好时机，才引起了网络罪犯们的兴趣和注意。尽管它起初貌似已经成为木马界的新宠，但经过RSA的深入分析，证明它并非一款真正的商业恶意软件，只能算是一个雏形，使感染漏洞的Linux主机的浏览器崩溃，而在获取适当的数据方面，几乎没有能力。”</p>
<p>关于那个入侵Linux的关键问题，“HoT的开发者声称他已经进入实施某种Web入侵机制的最终实现阶段，但是鉴于他之前开发并号称通过测试的‘表单窃取’功能并未生效，所以该Web入侵也可能无法生效。”</p>
<p>文章最后，我可以进一步得出结论：无论过去或将来，唯一会因HoT陷入麻烦的，只有购买了这款无可救药的残废木马的黑客们！</p>
<p>文章作者简介：</p>
<p>Steven J. Vaughan-Nichols，亦称sjvn，早在上世纪80年代，CP/M-80还是最新的操作系统的时候，就开始撰写技术及商业文章。范围涵盖网络、Linux、开源以及操作系统。</p>
<p>via: <a href="http://www.zdnet.com/linux-hot-bank-trojan-failed-malware-7000020436/">http://www.zdnet.com/linux-hot-bank-trojan-failed-malware-7000020436/</a></p>
<p>本文由 <a href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创翻译，<a href="http://linux.cn/portal.php">Linux中国</a> 荣誉推出</p>
<p>译者：<a href="http://linux.cn/space/14801">Mr小眼儿</a> 校对：<a href="http://linux.cn/space/jasminepeng">jasminepeng</a></p>
ks.com/2013/08/edit-a-linux-file-system-label/">http://tuxtweaks.com/2013/08/edit-a-linux-file-system-label/</a></p>
<p>本文由 <a href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创翻译，<a href="portal.php">Linux中国</a> 荣誉推出</p>
<p>译者：<a href="space/14455/">Luny</a> 校对：<a href="space/14763/">Caroline</a></p>
tu-381532.shtml">http://news.softpedia.com/news/How-to-Install-a-Google-Drive-Client-on-Ubuntu-381532.shtml</a></p>
随后正式采用 GPL 协议。</li>
<li><strong>1995 年 1 月</strong>，Bob Young 创办了 RedHat（小红帽），以 CNU/Linux 为核心，集成了 400 多个源代码开放的程序模块，搞出了一种冠以品牌的 Linux，即 RedHat Linux，称为 Linux “发行版”，在市场上出售。这在经营模式上是一种创举。</li>
<li><strong>1996 年 6 月</strong>，Linux 2.0 内核发布，此内核有大约 40 万行代码，并可以支持多个处理器。此时的 Linux 已经进入了实用阶段，全球大约有 350 万人使用。</li>
<li><strong>1998 年 2 月</strong>，以 Eric Raymond 为首的一批年轻的“老牛羚骨干分子”终于认识到 CNU/Linux 体系的产业化道路的本质，并非是什么自由哲学，而是市场竞争的驱动，创办了“Open Source Intiative”（开放源代码促进会）“复兴”的大旗，在互联网世界里展开了一场历史性的 Linux 产业化运动。</li>
<li><strong>2001 年 1 月</strong>，Linux 2.4 发布，它进一步地提升了 SMP 系统的扩展性，同时它也集成了很多用于支持桌面系统的特性：USB，PC卡（PCMCIA）的支持，内置的即插即用，等等功能。</li>
<li><strong>2003 年 12 月</strong>，Linux 2.6 版内核发布，相对于 2.4 版内核 2.6 在对系统的支持都有很大的变化。</li>
<li><strong>2004 年 1 月</strong>，SuSE 嫁到了 Novell，SCO 继续顶着骂名四处强行“化缘 “， Asianux， MandrakeSoft 也在五年中首次宣布季度赢利。3 月 SGI 宣布成功实现了 Linux 操作系统支持 256 个 Itanium 2 处理器。</li>
</ul>
<p><img src="https://img.linux.net.cn/xwb/images/bgimg/icon_logo.png" alt="" /> 已同步至 <a href="http://weibo.com/1772191555/A6FLy8H07">linux的微博</a></p>
t            
Su     2  9 16 23 30     6 13 20 27        4 11 18 25     1  8 15 22 29   
Mo     3 10 17 24 31     7 14 21 28        5 12 19 26     2  9 16 23 30   
Tu     4 11 18 25     1  8 15 22 29        6 13 20 27     3 10 17 24 31   
We     5 12 19 26     2  9 16 23 30        7 14 21 28     4 11 18 25      
Th     6 13 20 27     3 10 17 24        1  8 15 22 29     5 12 19 26      
Fr     7 14 21 28     4 11 18 25        2  9 16 23 30     6 13 20 27      
Sa  1  8 15 22 29     5 12 19 26        3 10 17 24 31     7 14 21 28      

    September         October           November          December          
Su     5 12 19 26        3 10 17 24 31     7 14 21 28        5 12 19 26   
Mo     6 13 20 27        4 11 18 25     1  8 15 22 29        6 13 20 27   
Tu     7 14 21 28        5 12 19 26     2  9 16 23 30        7 14 21 28   
We  1  8 15 22 29        6 13 20 27     3 10 17 24        1  8 15 22 29   
Th  2  9 16 23 30        7 14 21 28     4 11 18 25        2  9 16 23 30   
Fr  3 10 17 24        1  8 15 22 29     5 12 19 26        3 10 17 24 31   
Sa  4 11 18 25        2  9 16 23 30     6 13 20 27        4 11 18 25
</code></pre>
<p><strong>问11、如何显示某个月和某个月前几个月和后几个月的日历</strong></p>
<p>答：使用 cal 命令添加 -m -B -A 参数和月个数</p>
<pre><code>$ cal -m4 -B2 -A2
   February 2013           March 2013            April 2013       
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  
                1  2                  1  2      1  2  3  4  5  6  
 3  4  5  6  7  8  9   3  4  5  6  7  8  9   7  8  9 10 11 12 13  
10 11 12 13 14 15 16  10 11 12 13 14 15 16  14 15 16 17 18 19 20  
17 18 19 20 21 22 23  17 18 19 20 21 22 23  21 22 23 24 25 26 27  
24 25 26 27 28        24 25 26 27 28 29 30  28 29 30              
                      31                                          

      May 2013             June 2013        
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  
          1  2  3  4                     1  
 5  6  7  8  9 10 11   2  3  4  5  6  7  8  
12 13 14 15 16 17 18   9 10 11 12 13 14 15  
19 20 21 22 23 24 25  16 17 18 19 20 21 22  
26 27 28 29 30 31     23 24 25 26 27 28 29  
                      30
</code></pre>
<p>　　显示结果上，您可以看出，我们想显示 4 月份和 4 月份前两个月和后两个月的日历。如果您想显示指定年份的日历同时在显示年份前后的几个月，那么直需要在添加 -y 参数和四位数的年份即可：</p>
<pre><code>$ cal -y 2012 -B2 -A2
   November 2011         December 2011          January 2012      
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  
       1  2  3  4  5               1  2  3   1  2  3  4  5  6  7  
 6  7  8  9 10 11 12   4  5  6  7  8  9 10   8  9 10 11 12 13 14  
13 14 15 16 17 18 19  11 12 13 14 15 16 17  15 16 17 18 19 20 21  
20 21 22 23 24 25 26  18 19 20 21 22 23 24  22 23 24 25 26 27 28  
27 28 29 30           25 26 27 28 29 30 31  29 30 31              

   February 2012           March 2012            April 2012       
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  
          1  2  3  4               1  2  3   1  2  3  4  5  6  7  
 5  6  7  8  9 10 11   4  5  6  7  8  9 10   8  9 10 11 12 13 14  
12 13 14 15 16 17 18  11 12 13 14 15 16 17  15 16 17 18 19 20 21  
19 20 21 22 23 24 25  18 19 20 21 22 23 24  22 23 24 25 26 27 28  
26 27 28 29           25 26 27 28 29 30 31  29 30                 

      May 2012             June 2012             July 2012        
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  
       1  2  3  4  5                  1  2   1  2  3  4  5  6  7  
 6  7  8  9 10 11 12   3  4  5  6  7  8  9   8  9 10 11 12 13 14  
13 14 15 16 17 18 19  10 11 12 13 14 15 16  15 16 17 18 19 20 21  
20 21 22 23 24 25 26  17 18 19 20 21 22 23  22 23 24 25 26 27 28  
27 28 29 30 31        24 25 26 27 28 29 30  29 30 31              

    August 2012          September 2012         October 2012      
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  
          1  2  3  4                     1      1  2  3  4  5  6  
 5  6  7  8  9 10 11   2  3  4  5  6  7  8   7  8  9 10 11 12 13  
12 13 14 15 16 17 18   9 10 11 12 13 14 15  14 15 16 17 18 19 20  
19 20 21 22 23 24 25  16 17 18 19 20 21 22  21 22 23 24 25 26 27  
26 27 28 29 30 31     23 24 25 26 27 28 29  28 29 30 31           
                      30                                          

   November 2012         December 2012          January 2013      
Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  Su Mo Tu We Th Fr Sa  
             1  2  3                     1         1  2  3  4  5  
 4  5  6  7  8  9 10   2  3  4  5  6  7  8   6  7  8  9 10 11 12  
11 12 13 14 15 16 17   9 10 11 12 13 14 15  13 14 15 16 17 18 19  
18 19 20 21 22 23 24  16 17 18 19 20 21 22  20 21 22 23 24 25 26  
25 26 27 28 29 30     23 24 25 26 27 28 29  27 28 29 30 31        
                      30 31                                       

   February 2013      
Su Mo Tu We Th Fr Sa  
                1  2  
 3  4  5  6  7  8  9  
10 11 12 13 14 15 16  
17 18 19 20 21 22 23  
24 25 26 27 28
</code></pre>
<p>　　从结果上我们看到，除了 2012 年整年外，我们还能看到 2011 年最后俩月和 2013 年前俩月的日历。</p>
<p><strong>问12、如何让 ncal 命令显示成 cal 命令的结果</strong></p>
<p>答：可以使用 -C 参数来完成这一点</p>
<pre><code>$ ncal
    July 2013         
Su     7 14 21 28   
Mo  1  8 15 22 29   
Tu  2  9 16 23 30   
We  3 10 17 24 31   
Th  4 11 18 25      
Fr  5 12 19 26      
Sa  6 13 20 27      

$ cal
     July 2013        
Su Mo Tu We Th Fr Sa  
    1  2  3  4  5  6  
 7  8  9 10 11 12 13  
14 15 16 17 18 19 20  
21 22 23 24 25 26 27  
28 29 30 31           

$ ncal -C
     July 2013        
Su Mo Tu We Th Fr Sa  
    1  2  3  4  5  6  
 7  8  9 10 11 12 13  
14 15 16 17 18 19 20  
21 22 23 24 25 26 27  
28 29 30 31
</code></pre>
<p>　　同样，你可以使用 -N 参数来让 cal 命令看起来和 ncal 一样：</p>
<pre><code>$ cal
     July 2013        
Su Mo Tu We Th Fr Sa  
    1  2  3  4  5  6  
 7  8  9 10 11 12 13  
14 15 16 17 18 19 20  
21 22 23 24 25 26 27  
28 29 30 31           

$ ncal
    July 2013         
Su     7 14 21 28   
Mo  1  8 15 22 29   
Tu  2  9 16 23 30   
We  3 10 17 24 31   
Th  4 11 18 25      
Fr  5 12 19 26      
Sa  6 13 20 27      

$ cal -N
    July 2013         
Su     7 14 21 28   
Mo  1  8 15 22 29   
Tu  2  9 16 23 30   
We  3 10 17 24 31   
Th  4 11 18 25      
Fr  5 12 19 26      
Sa  6 13 20 27
</code></pre>
<p><strong>问13、如何让日历显示成以周一为每周第一天的样子</strong></p>
<p>答：使用 ncal 命令添加 -M 参数即可</p>
<pre><code>$ ncal -M
    July 2013         
Mo  1  8 15 22 29   
Tu  2  9 16 23 30   
We  3 10 **17** 24 31   
Th  4 11 18 25      
Fr  5 12 19 26      
Sa  6 13 20 27      
Su  7 14 21 28
</code></pre>
<p>　　还有一个 -S 参数，可以按周日为第一天来显示</p>
<p><strong>问14、如何切换 ncal 命令为以前的显示方式</strong></p>
<p>答：使用 ncal 命令添加 -b 参数</p>
<pre><code>$ ncal
    July 2013         
Su     7 14 21 28   
Mo  1  8 15 22 29   
Tu  2  9 16 23 30   
We  3 10 **17** 24 31   
Th  4 11 18 25      
Fr  5 12 19 26      
Sa  6 13 20 27      

$ ncal -b
     July 2013        
Su Mo Tu We Th Fr Sa  
    1  2  3  4  5  6  
 7  8  9 10 11 12 13  
14 15 16 **17** 18 19 20  
21 22 23 24 25 26 27  
28 29 30 31
</code></pre>
<p><strong>cal 和 ncal 命令的一些其他相关信息</strong></p>
<p>　　虽然我们可以查看这两个的命令的 man page 来得到更多的信息，不过在这里，我还有一些其他信息要告诉大家。需要指定年份的时候，我们需要四位数的年份。不是所有的参数都可以同时使用的，比如 -y, -3, -1 他们之间是冲突的，如果同时使用，后面的参数会覆盖掉前面的参数。</p>
<p><img src="https://img.linux.net.cn/xwb/images/bgimg/icon_logo.png" alt="" /> 已同步至 <a href="http://weibo.com/1772191555/A0J996mbe">linux的微博</a></p>
来声明常量了。那么当定义常量时，该使用哪种方式呢？</p>
<p>答案在于这两种方法之间的区别。</p>
<ol>
<li>define()在执行期定义常量，而const在编译期定义常量。这样const就有轻微的速度优势， 但不值得考虑这个问题，除非你在构建大规模的软件。</li>
<li>define()将常量放入全局作用域，虽然你可以在常量名中包含命名空间。这意味着你不能 使用define()定义类常量。</li>
<li>define()允许你在常量名和常量值中使用表达式，而const则都不允许。这使得define() 更加灵活。</li>
<li>define()可以在if()代码块中调用，但const不行。</li>
</ol>
<p><strong>示例</strong></p>
<p>因为define()更加灵活，你应该使用它以避免一些令人头疼的事情，除非你明确地需要类 常量。使用const通常会产生更加可读的代码，但是以牺牲灵活性为代价的。</p>
<p>无论你选择哪一种，请保持一致。</p>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://stackoverflow.com/questions/2447791/define-vs-const">Stack Overflow: define() vs. const</a></li>
<li><a href="http://www.php.net/manual/en/language.constants.syntax.php">PHP手册：常量</a></li>
<li><a href="http://stackoverflow.com/questions/1225082/define-vs-variable-in-php">Stack Overflow: define() vs. 变量</a></li>
</ul>
<h2 id="php-opcode">缓存PHP opcode</h2>
<h3 id="apchttpphpnetmanualenbookapcphp">使用<a href="http://php.net/manual/en/book.apc.php">APC</a></h3>
<p>在一个标准的PHP环境中，每次访问PHP脚本时，脚本都会被编译然后执行。一次又一次地花费 时间编译相同的脚本对于大型站点会造成性能问题。</p>
<p>解决方案是采用一个opcode缓存。opcode缓存是一个能够记下每个脚本经过编译的版本，这样 服务器就不需要浪费时间一次又一次地编译了。通常这些opcode缓存系统也能智能地检测到 一个脚本是否发生改变，因此当你升级PHP源码时，并不需要手动清空缓存。</p>
<p>有几个PHP opcode缓存可用，其中值得关注的有<a href="http://sourceforge.net/projects/eaccelerator/">eaccelerator</a>， <a href="http://xcache.lighttpd.net/">xcache</a>，以及<a href="http://php.net/manual/en/book.apc.php">APC</a>。 APC是PHP项目官方支持的，最为活跃，也最容易安装。它也提供一个可选的类<a href="http://memcached.org/">memcached</a> 的持久化键-值对存储，因此你应使用它。</p>
<p><strong>安装APC</strong></p>
<p>在Ubuntu 12.04上你可以通过在终端中执行以下命令来安装APC：</p>
<p>user@localhost: sudo apt-get install php-apc</p>
<p>除此之外，不需要进一步的配置。</p>
<p><strong>将APC作为一个持久化键-值存储系统来使用</strong></p>
<p>APC也提供了对于你的脚本透明的类似于memcached的功能。与使用memcached相比一个大的优势是 APC是集成到PHP核心的，因此你不需要在服务器上维护另一个运行的部件，并且PHP开发者在APC 上的工作很活跃。但从另一方面来说，APC并不是一个分布式缓存，如果你需要这个特性，你就 必须使用memcached了。</p>
<p><strong>示例</strong></p>
<p><strong>陷阱</strong></p>
<ul>
<li>如果你使用的不是<a href="https://phpbestpractices.org/#serving-php">PHP-FPM</a>（例如你在 使用<a href="http://stackoverflow.com/questions/2712825/what-is-mod-php">mod_php</a> 或<a href="http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html">mod_fastcgi</a>），那么 每个PHP进程都会有自己独有的APC实例，包括键-值存储。若你不注意，这可能会在你的应用 代码中造成同步问题。</li>
</ul>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://php.net/manual/en/book.apc.php">PHP手册：APC</a></li>
</ul>
<h2 id="phpmemcached">PHP与Memcached</h2>
<h3 id="memcachedhttpphpnetmanualenbookmemcachedphpapc">若你需要一个分布式缓存，那就使用<a href="http://php.net/manual/en/book.memcached.php">Memcached</a>客户端库。否则，使用APC。</h3>
<p>缓存系统通常能够提升应用的性能。Memcached是一个受欢迎的选择，它能配合许多语言使用， 包括PHP。</p>
<p>然而，从一个PHP脚本中访问一个Memcached服务器，你有两个不同且命名很愚蠢的客户端库选择项：<a href="http://php.net/manual/en/book.memcache.php">Memcache</a>和<a href="http://php.net/manual/en/book.memcached.php">Memcached</a>。 它们是两个名字几乎相同的不同库，两者都可用于访问一个Memcached实例。</p>
<p>事实证明，Memcached库对于Memcached协议的实现最好，包含了一些Mmecache库没有的有用的特性， 并且看起来Memcached库的开发也最为活跃。</p>
<p>然而，如果不需要访问来自一组分布式服务器的一个Memcached实例，那就<a href="https://phpbestpractices.org/#opcode-cache">使用APC</a>。 APC得到PHP项目的支持，具备很多和Memcached相同的功能，并且能够用作opcode缓存，这能提高PHP脚本的性能。</p>
<p><strong>安装Memcached客户端库</strong></p>
<p>在安装Memcached服务器之后，需要安装Memcached客户端库。没有该库，PHP脚本就没法与 Memcached服务器通信。</p>
<p>在Ubuntu 12.04上，你可以使用如下命令来安装Memcached客户端库：</p>
<p>user@localhost: sudo apt-get install php5-memcached</p>
<p><strong>使用APC作为替代</strong></p>
<p>查看<a href="https://phpbestpractices.org/#opcode-cache">opcode缓存一节</a>阅读更多与使用APC作为 Memcached替代方案相关的信息。</p>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://php.net/manual/en/book.memcached.php">PHP手册：Memcached</a></li>
<li><a href="http://php.net/manual/en/book.apc.php">PHP手册：APC</a></li>
<li><a href="http://stackoverflow.com/questions/1442411/using-memcache-vs-memcached-with-php">Stack Overflow: PHP中使用Memcache vs. Memcached</a></li>
<li><a href="http://stackoverflow.com/questions/815041/memcached-vs-apc-which-one-should-i-choose">Stack Overflow: Memcached vs APC，我该选择哪一个？</a></li>
</ul>
<h2 id="php-2">PHP与正则表达式</h2>
<h3 id="pcrehttpphpnetmanualenbookpcrephppreg-">使用<a href="http://php.net/manual/en/book.pcre.php">PCRE</a>(preg_*)家族函数</h3>
<p>PHP有两种使用不同的方式来使用正则表达式：PCRE（Perl兼容表示法，preg_*）函数 和<a href="http://php.net/manual/en/book.regex.php">POSIX</a>（POSIX扩展表示法，ereg_*） 函数。</p>
<p>每个函数家族各自使用一种风格稍微不同的正则表达式。幸运的是，POSIX家族函数从PHP 5.3.0开始就被弃用了。因此，你绝不应该使用POSIX家族函数编写新的代码。始终使用 PRCE家族函数，即preg_*函数。</p>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://php.net/manual/en/book.pcre.php">PHP手册：PCRE</a></li>
<li><a href="http://www.noupe.com/php/php-regular-expressions.html">PHP正则表达式起步</a></li>
</ul>
<h2 id="webphp">配置Web服务器提供PHP服务</h2>
<h3 id="php-fpmhttpphpnetmanualeninstallfpmphp">使用<a href="http://php.net/manual/en/install.fpm.php">PHP-FPM</a></h3>
<p>有多种方式来配置一个web服务器以提供PHP服务。传统（并且糟糕的）的方式是使用Apache的 <a href="http://stackoverflow.com/questions/2712825/what-is-mod-php">mod_php</a>。Mod_php将PHP 绑定到Apache自身，但是Apache对于该模块功能的管理工作非常糟糕。一旦遇到较大的流量， 就会遭受严重的内存问题。</p>
<p>后来两个新的可选项很快流行起来：<a href="http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html">mod_fastcgi</a> 和<a href="http://httpd.apache.org/mod_fcgid/">mod_fcgid</a>。两者均保持一定数量的PHP执行进程， Apache将请求发送到这些端口来处理PHP的执行。由于这些库限制了存活的PHP进程的数量， 从而大大减少了内存使用而没有影响性能。</p>
<p>一些聪明的人创建一个fastcgi的实现，专门为真正与PHP工作良好而设计，他们称之为 <a href="http://php.net/manual/en/install.fpm.php">PHP-FPM</a>。PHP 5.3.0之前，为安装它， 你得跨越许多障碍，但幸运的是，PHP 5.3.3的核心包含了PHP-FPM，因此在Ubuntu 12.04上安装它非常方便。</p>
<p>如下示例是针对Apache 2.2.22的，但PHP-FPM也能用于其他web服务器如Nginx。</p>
<p><strong>安装PHP-FPM和Apache</strong></p>
<p>在Ubuntu 12.04上你可以使用如下命令安装PHP-FPM和Apache：</p>
<p>user@localhost: sudo apt-get install apache2-mpm-worker<br />
libapache2-mod-fastcgi php5-fpm<br />
user@localhost: sudo a2enmod actions alias fastcgi</p>
<p>注意我们<em>必须</em>使用apache2-mpm-worker，而不是apache2-mpm-prefork或apache2-mpm-threaded。</p>
<p>接下来配置Aapache虚拟主机将PHP请求路由到PHP-FPM进程。将如下配置语句放入Apache 配置文件（在Ubuntu 12.04上默认配置文件是/etc/apache2/sites-available/default）。</p>
<pre><code>    AddHandler php5-fcgi .php
    Action php5-fcgi /php5-fcgi
    Alias /php5-fcgi /usr/lib/cgi-bin/php5-fcgi
    FastCgiExternalServer /usr/lib/cgi-bin/php5-fcgi -host 127.0.0.1:9000 -idle-timeout 120 -pass-header Authorization

</code></pre>
<p>最后，重启Apache和FPM进程：</p>
<p>user@localhost: sudo service apache2 restart &amp;&amp; sudo service php5-fpm<br />
restart</p>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://php.net/manual/en/install.fpm.php">PHP手册：PHP-FPM</a></li>
<li><a href="http://php-fpm.org/">PHP-FPM主页</a></li>
<li><a href="https://alexcabal.com/installing-apache-mod_fastcgi-php-fpm-on-ubuntu-server-maverick/">在Ubuntu服务器Maverick上安装Apache + mod_fastcgi + PHP-FPM</a></li>
<li><a href="http://www.joomlaperformance.com/articles/webcasts/why_mod_php_is_bad_for_performance_52_58.html">为什么mod_php的性能很糟糕</a></li>
</ul>
<h2 id="heading-7">发送邮件</h2>
<h3 id="phpmailerhttpscodegooglecomaapache-extrasorgpphpmailer">使用<a href="https://code.google.com/a/apache-extras.org/p/phpmailer/">PHPMailer</a></h3>
<p><em>经PHPMailer 5.1测试</em></p>
<p>PHP提供了一个<a href="http://php.net/manual/en/function.mail.php">mail()</a>函数，看起来很简单易用。 不幸的是，与PHP中的很多东西一样，它的简单性是个幻象，因其虚假的表面使用它会导致 严重的安全问题。</p>
<p>Email是一组网络协议，比PHP的历史还曲折。完全可以说发送邮件中的陷阱与PHP的mail() 函数一样多，这个可能会令你有点“不寒而栗”吧。</p>
<p><a href="http://code.google.com/a/apache-extras.org/p/phpmailer/">PHPMailer</a>是一个流行而 成熟的开源库，为安全地发送邮件提供一个易用的接口。它关注可能陷阱，这样你可以专注 于更重要的事情。</p>
<p><strong>示例</strong></p>
<pre><code>Sender = 'bbaggins@example.com';
$mailer-&gt;AddReplyTo('bbaggins@example.com', 'Bilbo Baggins');
$mailer-&gt;SetFrom('bbaggins@example.com', 'Bilbo Baggins');
$mailer-&gt;AddAddress('gandalf@example.com');
$mailer-&gt;Subject = 'The finest weed in the South Farthing';
$mailer-&gt;MsgHTML('
</code></pre>
<p>You really must try it, Gandalf!</p>
<p>-Bilbo</p>
<pre><code>');
 
// Set up our connection information.
$mailer-&gt;IsSMTP();
$mailer-&gt;SMTPAuth = true;
$mailer-&gt;SMTPSecure = 'ssl';
$mailer-&gt;Port = 465;
$mailer-&gt;Host = 'my smpt host';
$mailer-&gt;Username = 'my smtp username';
$mailer-&gt;Password = 'my smtp password';
 
// All done!
$mailer-&gt;Send();
?&gt;
</code></pre>
<h2 id="heading-8">验证邮件地址</h2>
<h3 id="filter-varhttpphpnetmanualenfunctionfilter-varphp">使用<a href="http://php.net/manual/en/function.filter-var.php">filter_var()</a>函数</h3>
<p>Web应用可能需要做的一件常见任务是检测用户是否输入了一个有效的邮件地址。毫无疑问 你可以在网上找到一些声称可以解决该问题的复杂的正则表达式，但是最简单的方法是使用 PHP的内建filter_val()函数。</p>
<p><strong>示例</strong></p>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://php.net/manual/en/function.filter-var.php">PHP手册：filter_var()</a></li>
<li><a href="http://php.net/manual/en/filter.filters.php">PHP手册：过滤器的类型</a></li>
</ul>
<h2 id="html">净化HTML输入和输出</h2>
<p><strong>对于简单的数据净化，使用<a href="http://php.net/manual/en/function.htmlentities.php">htmlentities()</a>函数, 复杂的数据净化则使用<a href="http://htmlpurifier.org/">HTML Purifier</a>库</strong></p>
<p><em>经HTML Purifier 4.4.0测试</em></p>
<p>在任何wbe应用中展示用户输出时，首先对其进行“净化”去除任何潜在危险的HTML是非常必要的。 一个恶意的用户可以制作某些HTML，若被你的web应用直接输出，对查看它的人来说会很危险。</p>
<p>虽然可以尝试使用正则表达式来净化HTML，但不要这样做。HTML是一种复杂的语言，试图 使用正则表达式来净化HTML几乎总是失败的。</p>
<p>你可能会找到建议你使用<a href="http://php.net/manual/en/function.strip-tags.php">strip_tags()</a> 函数的观点。虽然strip_tags()从技术上来说是安全的，但如果输入的不合法的HTML（比如， 没有结束标签），它就成了一个“愚蠢”的函数，可能会去除比你期望的更多的内容。由于非技术用户 在通信中经常使用&lt;和&gt;字符，strip_tags()也就不是一个好的选择了。</p>
<p>如果阅读了<a href="https://phpbestpractices.org/#validating-emails">验证邮件地址</a>一节， 你也许也会考虑使用<a href="http://php.net/manual/en/function.filter-var.php">filter_var()</a> 函数。然而<a href="http://stackoverflow.com/questions/3150413/filter-sanitize-special-chars-problem-with-line-breaks">filter_var()函数在遇到断行时会出现问题</a>， 并且需要不直观的配置以接近<a href="http://php.net/manual/en/function.htmlentities.php">htmlentities()</a>函数的效果， 因此也不是一个好的选择。</p>
<p><strong>对于简单需求的净化</strong></p>
<p>如果你的web应用仅需要完全地转义（因此可以无害地呈现，但不是完全去除）HTML，则使用 PHP的内建<a href="http://php.net/manual/en/function.htmlentities.php">htmlentities()</a>函数。 这个函数要比HTML Purifier快得多，因此它不对HTML做任何验证—仅转义所有东西。</p>
<p>htmlentities()不同于类似功能的函数<a href="http://php.net/manual/en/function.htmlspecialchars.php">htmlspecialchars()</a>， 它会编码所有适用的HTML实体，而不仅仅是一个小的子集。</p>
<p><strong>示例</strong></p>
<pre><code>Mua-ha-ha!  Twiddling my evil mustache...
</code></pre>
<p>'; // Use the ENT_QUOTES flag to make sure both single and double // quotes are escaped. // Use the UTF-8 character encoding if you've stored the text as // UTF-8 (as you should have). // See the UTF-8 section in this document for more details. $safeHtml = htmlentities($evilHtml, ENT_QUOTES, 'UTF-8'); // $safeHtml is now fully escaped HTML. You can output $safeHtml // to your users without fear! ?&gt;</p>
<p><strong>对于复杂需求的净化</strong></p>
<p>对于很多web应用来说，简单地转义HTML是不够的。你可能想完全去除任何HTML，或者允许 一小部分子集的HTML存在。若是如此，则使用<a href="http://htmlpurifier.org/">HTML Purifier</a> 库。</p>
<p>HTML Purifier是一个经过充分测试但效率比较低的库。这就是为什么如果你的需求并不复杂 就应使用<a href="http://php.net/manual/en/function.htmlentities.php">htmlentities()</a>，因为 它的效率要快得多。</p>
<p>HTML Purifier相比<a href="http://php.net/manual/en/function.strip-tags.php">strip_tags()</a> 是有优势的，因为它在净化HTML之前会对其校验。这意味着如果用户输入无效HTML，HTML Purifier相比strip_tags()更能保留HTML的原意。HTML Purifier高度可定制，允许你为HTML的一个子集建立白名单来允许这个HTML子集的实体存在 输出中。</p>
<p>但其缺点就是相当的慢，它要求一些设置，在一个共享主机的环境里可能是不可行的。其文档 通常也复杂而不易理解。以下示例是一个基本的使用配置。查看<a href="http://htmlpurifier.org/docs">文档</a> 阅读HTML Purifier提供的更多更高级的特性。</p>
<p><strong>示例</strong></p>
<pre><code>Mua-ha-ha!  Twiddling my evil mustache...';
 
// Set up the HTML Purifier object with the default configuration.
$purifier = new HTMLPurifier(HTMLPurifier_Config::createDefault());
 
$safeHtml = $purifier-&gt;purify($evilHtml);
// $safeHtml is now sanitized.  You can output $safeHtml to your 
// users without fear!
?&gt;
</code></pre>
<p><strong>陷阱</strong></p>
<ul>
<li>以错误的字符编码使用htmlentities()会造成意想不到的输出。在调用该函数时始终确认 指定了一种字符编码，并且该编码与将被净化的字符串的编码相匹配。更多细节请查看 <a href="https://phpbestpractices.org/#utf-8">UTF-8一节</a>。</li>
<li>使用htmlentities()时，始终包含ENT_QUOTES和字符编码参数。默认情况下，htmlentities() 不会对单引号编码。多愚蠢的默认做法！</li>
<li>HTML Purifier对于复杂的HTML效率极其的低。可以考虑设置一个缓存方案如APC来保存经过净化的结果 以备后用。</li>
</ul>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://htmlpurifier.org/comparison">PHP HTML净化工具对比</a></li>
<li><a href="http://stackoverflow.com/questions/3605629/php-prevent-xss-with-strip-tags">Stack Overflow: 使用strip_tags()来防止XSS？</a></li>
<li><a href="http://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php">Stack Overflow: PHP中净化用户输入的最佳方法是什么？</a></li>
<li><a href="http://stackoverflow.com/questions/3150413/filter-sanitize-special-chars-problem-with-line-breaks">Stack Overflow: 断行时的FILTER_SANITIZE_SPECIAL_CHARS问题</a></li>
</ul>
<h2 id="phputf-8">PHP与UTF-8</h2>
<h3 id="heading-9">没有一行式解决方案。小心、注意细节，以及一致性。</h3>
<p>PHP中的UTF-8糟透了。原谅我的用词。</p>
<p>目前PHP在低层次上还不支持Unicode。有几种方式可以确保UTF-8字符串能够被正确处理， 但并不容易，需要深入到web应用的所有层面，从HTML，到SQL，到PHP。我们旨在提供一个简洁、 实用的概述。</p>
<p><strong>PHP层面的UTF-8</strong></p>
<p>基本的<a href="http://php.net/manual/en/language.operators.string.php">字符串操作</a>，如串接 两个字符串、将字符串赋给变量，并不需要任何针对UTF-8的特殊东西。然而，多数 <a href="http://php.net/manual/en/ref.strings.php">字符串函数</a>，如<a href="http://php.net/manual/en/function.strpos.php">strpos()</a> 和<a href="http://php.net/manual/en/function.strlen.php">strlen</a>，就需要特殊的考虑。这些 函数都有一个对应的mb_*函数：例如，<a href="http://php.net/manual/en/function.mb-strpos.php">mb_strpos()</a>和<a href="http://php.net/manual/en/function.mb-strlen.php">mb_strlen()</a>。这些对应的函数 统称为<a href="http://php.net/manual/en/ref.mbstring.php">多字节字符串函数</a>。这些多字节字符串 函数是专门为操作Unicode字符串而设计的。</p>
<p>当你操作Unicode字符串时，必须使用mb_*函数。例如，如果你使用<a href="http://php.net/manual/en/function.substr.php">substr()</a> 操作一个UTF-8字符串，其结果就很可能包含一些乱码。正确的函数应该是对应的多字节函数， <a href="http://php.net/manual/en/function.mb-substr.php">mb_substr()</a>。</p>
<p>难的是始终记得使用mb_*函数。即使你仅一次忘了，你的Unicode字符串在接下来的处理中 就可能产生乱码。</p>
<p>并不是所有的字符串函数都有一个对应的mb_*。如果不存在你想要的那一个，那你就只能 自认倒霉了。</p>
<p>此外，在每个PHP脚本的顶部（或者在全局包含脚本的顶部）你都应使用 <a href="http://php.net/manual/en/function.mb-internal-encoding.php">mb_internal_encoding</a> 函数，如果你的脚本会输出到浏览器，那么还得紧跟其后加个<a href="http://php.net/manual/en/function.mb-http-output.php">mb_http_output()</a> 函数。在每个脚本中显式地定义字符串的编码在以后能为你减少很多令人头疼的事情。</p>
<p>最后，许多操作字符串的PHP函数都有一个可选参数让你指定字符编码。若有该选项， 你应 始终显式地指明UTF-8编码。例如，<a href="http://php.net/manual/en/function.htmlentities.php">htmlentities()</a> 就有一个字符编码方式选项，在处理这样的字符串时应始终指定UTF-8。</p>
<p><strong>MySQL层面的UTF-8</strong></p>
<p>如果你的PHP脚本会访问MySQL，即使你遵从了前述的注意事项，你的字符串也有可能在数据库 中存储为非UTF-8字符串。</p>
<p>确保从PHP到MySQL的字符串为UTF-8编码的，确保你的数据库以及数据表均设置为utf8mb4字符集， 并且在你的数据库中执行任何其他查询之前先执行MySQL查询<code>set names utf8mb4</code>。这是至关重要的。示例 请查看<a href="https://phpbestpractices.org/#mysql">连接并查询MySQL数据库</a>一节内容。</p>
<p>注意你必须使用<code>utf8mb4</code>字符集来获得完整的UTF-8支持，而不是<code>utf8</code>字符集！原因 请查看<a href="https://phpbestpractices.org/#utf8-further-reading">进一步阅读</a>。</p>
<p><strong>浏览器层面的UTF-8</strong></p>
<p>使用<a href="http://php.net/manual/en/function.mb-http-output.php">mb_http_output()</a>函数 来确保你的PHP脚本输出UTF-8字符串到浏览器。并且在HTML页面的标签块中包含<a href="http://htmlpurifier.org/docs/enduser-utf8.html">字符集标签块</a>。</p>
<p><strong>示例</strong></p>
<pre><code> \PDO::ERRMODE_EXCEPTION,
                        \PDO::ATTR_PERSISTENT =&gt; false,
                        \PDO::MYSQL_ATTR_INIT_COMMAND =&gt; 'set names utf8mb4'
                    )
                );
     
// Store our transformed string as UTF-8 in our database
// Assume our DB and tables are in the utf8mb4 character set and collation
$handle = $link-&gt;prepare('insert into Sentences (Id, Body) values (?, ?)');
$handle-&gt;bindValue(1, 1, PDO::PARAM_INT);
$handle-&gt;bindValue(2, $string);
$handle-&gt;execute();
 
// Retrieve the string we just stored to prove it was stored correctly
$handle = $link-&gt;prepare('select * from Sentences where Id = ?');
$handle-&gt;bindValue(1, 1, PDO::PARAM_INT);
$handle-&gt;execute();
    
// Store the result into an object that we'll output later in our HTML
$result = $handle-&gt;fetchAll(\PDO::FETCH_OBJ);
?&gt;UTF-8 test pageBody);  
            // This should correctly output our transformed UTF-8 string to the browser
        }
        ?&gt;

</code></pre>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://php.net/manual/en/ref.mbstring.php">PHP手册：多字节字符串函数</a></li>
<li><a href="http://blog.loftdigital.com/blog/php-utf-8-cheatsheet">PHP UTF-8备忘单</a></li>
<li><a href="http://stackoverflow.com/questions/571694/what-factors-make-php-unicode-incompatible">Stack Overflow: 什么因素致使PHP不兼容Unicode？</a></li>
<li><a href="http://stackoverflow.com/questions/140728/best-practices-in-php-and-mysql-with-international-strings">Stack Overflow: PHP与MySQL之间国际化字符串的最佳实践</a></li>
<li><a href="http://mathiasbynens.be/notes/mysql-utf8mb4">怎样在MySQL数据库中完整支持Unicode</a></li>
</ul>
<h2 id="heading-10">处理日期和时间</h2>
<h3 id="datetimehttpwwwphpnetmanualenclassdatetimephp">使用<a href="http://www.php.net/manual/en/class.datetime.php">DateTime类</a>。</h3>
<p>在PHP糟糕的老时光里，我们必须使用<a href="http://www.php.net/manual/en/function.date.php">date()</a>， <a href="http://www.php.net/manual/en/function.gmdate.php">gmdate()</a>， <a href="http://www.php.net/manual/en/function.date-timezone-set.php">date_timezone_set()</a>， <a href="http://www.php.net/manual/en/function.strtotime.php">strtotime()</a>等等令人迷惑的 组合来处理日期和时间。悲哀的是现在你仍旧会找到很多在线教程在讲述这些不易使用的老式函数。</p>
<p>幸运的是，我们正在讨论的PHP版本包含友好得多的<a href="http://www.php.net/manual/en/class.datetime.php">DateTime类</a>。 该类封装了老式日期函数所有功能，甚至更多，在一个易于使用的类中，并且使得时区转换更加容易。 在PHP中始终使用DateTime类来创建，比较，改变以及展示日期。</p>
<p><strong>示例</strong></p>
<pre><code>add(new DateInterval('P10D'));
 
echo($date-&gt;format('Y-m-d h:i:s')); // 2011-05-14 05:00:00
 
// Sadly we don't have a Middle Earth timezone
// Convert our UTC date to the PST (or PDT, depending) time zone
$date-&gt;setTimezone(new DateTimeZone('America/Los_Angeles'));
 
// Note that if you run this line yourself, it might differ by an 
// hour depending on daylight savings
echo($date-&gt;format('Y-m-d h:i:s')); // 2011-05-13 10:00:00
 
$later = new DateTime('2012-05-20', new DateTimeZone('UTC'));
 
// Compare two dates
if($date &lt; $later)
    echo('Yup, you can compare dates using these easy operators!');
 
// Find the difference between two dates
$difference = $date-&gt;diff($later);
 
echo('The 2nd date is ' . $difference['days'] . ' later than 1st date.');
?&gt;
</code></pre>
<p><strong>陷阱</strong></p>
<ul>
<li>如果你不指定一个时区，<a href="http://www.php.net/manual/en/datetime.construct.php">DateTime::__construct()</a> 就会将生成日期的时区设置为正在运行的计算机的时区。之后，这会导致大量令人头疼的事情。 <strong>在创建新日期时始终指定UTC时区，除非你确实清楚自己在做的事情。</strong></li>
<li>如果你在DateTime::__construct()中使用Unix时间戳，那么时区将始终设置为UTC而不管 第二个参数你指定了什么。</li>
<li>向DateTime::__construct()传递零值日期（如：“0000-00-00”，常见MySQL生成该值作为 DateTime类型数据列的默认值）会产生一个无意义的日期，而不是“0000-00-00”。</li>
<li>在32位系统上使用<a href="http://www.php.net/manual/en/datetime.gettimestamp.php">DateTime::getTimestamp()</a> 不会产生代表2038年之后日期的时间戳。64位系统则没有问题。</li>
</ul>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://www.php.net/manual/en/book.datetime.php">PHP手册：DateTime类</a></li>
<li><a href="http://stackoverflow.com/questions/5319710/accessing-dates-in-php-beyond-2038">Stack Overflow: 访问超出2038的日期</a></li>
</ul>
<h2 id="nullfalse">检测一个值是否为null或false</h2>
<h3 id="httpphpnetmanualenlanguageoperatorscomparisonphpnullfalse">使用<a href="http://php.net/manual/en/language.operators.comparison.php">===</a>操作符来检测null和布尔false值。</h3>
<p>PHP宽松的类型系统提供了许多不同的方法来检测一个变量的值。然而这也造成了很多问题。 使用==来检测一个值是否为null或false，如果该值实际上是一个空字符串或0，也会误报 为false。<a href="http://php.net/manual/en/function.isset.php">isset</a>是检测一个变量是否有值， 而不是检测该值是否为null或false，因此在这里使用是不恰当的。</p>
<p><a href="http://php.net/manual/en/function.is-null.php">is_null()</a>函数能准确地检测一个值 是否为null，<a href="http://php.net/manual/en/function.is-bool.php">is_bool</a>可以检测一个值 是否是布尔值（比如false），但存在一个更好的选择：===操作符。===检测两个值是否同一， 这不同于PHP宽松类型世界里的<em>相等</em>。它也比is_null()和is_bool()要快一些，并且有些人 认为这比使用函数来做比较更干净些。</p>
<p><strong>示例</strong></p>
<p><strong>陷阱</strong></p>
<ul>
<li>测试一个返回0或布尔false的函数的返回值时，如strpos()，始终使用===和!==，否则 你就会碰到问题。</li>
</ul>
<p><strong>进一步阅读</strong></p>
<ul>
<li><a href="http://php.net/manual/en/language.operators.comparison.php">PHP手册：比较操作符</a></li>
<li><a href="http://stackoverflow.com/questions/8228837/is-nullx-vs-x-null-in-php">Stack Overflow: is_null() vs ===</a></li>
</ul>
<h2 id="heading-11">建议与指正</h2>
<p>感谢阅读！如果你有些地方还不太理解，很正常，PHP是复杂的，并且充斥着陷阱。因为我也 只是一个人，所以本文档中难免存在错误。</p>
<p>如果你想为本文档贡献建议或纠正错误之处，请使用<a href="https://phpbestpractices.org/#maintainers">最后修订日期&amp;维护者</a> 一节中的信息联系我。</p>
<p>原文： <a href="https://phpbestpractices.org/">PHP Best Practices-A short, practical guide for common and confusing PHP tasks</a></p>
<p>译者：<a href="https://github.com/youngsterxyf">youngsterxyf</a></p>

        </div>
    </div>
    <div class="share card">
<div class="copyright">
  <i class="fa-regular fa-copyright icon"></i>
  <div class="text">
    <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p> 
    <p>本文永久链接是：<a href=""></a></p>
  </div>
</div>
<div class="share">
  <a href="" class="link">
    <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M512 1024C229.228 1024 0 794.772 0 512S229.228 0 512 0s512 229.228 512 512-229.228 512-512 512z m54.545-565.02l-1.798-1.764a102.207 102.207 0 0 0-11.002-9.523l-35.453 35.442c4.176 2.446 8.078 5.393 11.605 8.92l1.866 1.763a58.277 58.277 0 0 1 0 82.341l-96.904 96.882a58.334 58.334 0 0 1-82.341 0l-1.832-1.798a58.243 58.243 0 0 1 0-82.306l43.816-43.828a149.675 149.675 0 0 1-10.866-58.732l-67.812 67.72c-41.836 41.825-41.836 110.251 0 152.053l1.787 1.798c41.836 41.79 110.228 41.79 152.052 0l96.882-96.916c41.757-41.825 41.757-110.25 0-152.052z m141.38-141.37l-1.82-1.797c-41.802-41.825-110.228-41.825-152.053 0l-96.882 96.916c-41.824 41.79-41.824 110.216 0 152.053l1.798 1.763c3.505 3.425 7.225 6.576 11.002 9.523l35.454-35.476a57.845 57.845 0 0 1-11.583-8.92l-1.798-1.763a58.311 58.311 0 0 1 0-82.375l96.905-96.882a58.197 58.197 0 0 1 82.284 0l1.798 1.797a58.277 58.277 0 0 1 0 82.341l-43.76 43.828c7.612 18.796 11.196 38.81 10.844 58.766l67.789-67.755c41.824-41.79 41.824-110.216 0.022-152.007z" p-id="4933" fill="#13227a"></path></svg>
  </a>
  <!--<a href="" class="wechart">
    <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M337.387283 341.82659c-17.757225 0-35.514451 11.83815-35.514451 29.595375s17.757225 29.595376 35.514451 29.595376 29.595376-11.83815 29.595376-29.595376c0-18.49711-11.83815-29.595376-29.595376-29.595375zM577.849711 513.479769c-11.83815 0-22.936416 12.578035-22.936416 23.6763 0 12.578035 11.83815 23.676301 22.936416 23.676301 17.757225 0 29.595376-11.83815 29.595376-23.676301s-11.83815-23.676301-29.595376-23.6763zM501.641618 401.017341c17.757225 0 29.595376-12.578035 29.595376-29.595376 0-17.757225-11.83815-29.595376-29.595376-29.595375s-35.514451 11.83815-35.51445 29.595375 17.757225 29.595376 35.51445 29.595376zM706.589595 513.479769c-11.83815 0-22.936416 12.578035-22.936416 23.6763 0 12.578035 11.83815 23.676301 22.936416 23.676301 17.757225 0 29.595376-11.83815 29.595376-23.676301s-11.83815-23.676301-29.595376-23.6763z" fill="#28C445" p-id="2404"></path><path d="M510.520231 2.959538C228.624277 2.959538 0 231.583815 0 513.479769s228.624277 510.520231 510.520231 510.520231 510.520231-228.624277 510.520231-510.520231-228.624277-510.520231-510.520231-510.520231zM413.595376 644.439306c-29.595376 0-53.271676-5.919075-81.387284-12.578034l-81.387283 41.433526 22.936416-71.768786c-58.450867-41.433526-93.965318-95.445087-93.965317-159.815029 0-113.202312 105.803468-201.988439 233.803468-201.98844 114.682081 0 216.046243 71.028902 236.023121 166.473989-7.398844-0.739884-14.797688-1.479769-22.196532-1.479769-110.982659 1.479769-198.289017 85.086705-198.289017 188.67052 0 17.017341 2.959538 33.294798 7.398844 49.572255-7.398844 0.739884-15.537572 1.479769-22.936416 1.479768z m346.265896 82.867052l17.757225 59.190752-63.630058-35.514451c-22.936416 5.919075-46.612717 11.83815-70.289017 11.83815-111.722543 0-199.768786-76.947977-199.768786-172.393063-0.739884-94.705202 87.306358-171.653179 198.289017-171.65318 105.803468 0 199.028902 77.687861 199.028902 172.393064 0 53.271676-34.774566 100.624277-81.387283 136.138728z" fill="#28C445" p-id="2405"></path></svg>
  </a>-->
  <a href="http://connect.qq.com/widget/shareqq/index.html?url=&title=&summary=" class="qq">
    <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M512 0C229.224296 0 0 229.224296 0 512s229.224296 512 512 512 512-229.224296 512-512S794.775704 0 512 0zM801.261037 668.86163c-21.731556 18.640593-49.948444-61.345185-54.006519-49.038222-9.879704 29.923556-14.506667 49.929481-43.633778 82.507852-1.554963 1.744593 33.659259 14.468741 43.633778 41.642667 9.557333 26.017185 28.141037 67.26163-93.487407 80.213333-71.35763 7.585185-122.936889-38.020741-128.075852-37.584593-9.53837 0.83437-5.290667 0-15.530667 0-8.38163 0-8.931556 0.606815-16.820148 0-2.161778-0.170667-25.884444 37.584593-131.963259 37.584593-82.223407 0-103.518815-51.749926-86.983111-80.213333 16.535704-28.463407 44.126815-36.750222 40.239407-41.263407-19.152593-22.186667-32.350815-45.909333-40.239407-67.356444-1.953185-5.347556-3.584-10.543407-4.873481-15.530667-2.996148-11.45363-25.884444 67.204741-50.460444 49.038222-24.576-18.166519-22.376296-64.417185-6.46637-108.676741 16.042667-44.619852 56.471704-87.589926 56.926815-97.071407 1.611852-35.290074-3.489185-41.14963 0-50.422519 7.755852-20.764444 17.199407-12.8 17.199407-23.570963 0-135.736889 100.864-245.76 225.28-245.76s225.28 110.042074 225.28 245.76c0 5.195852 13.520593 0 19.986963 23.570963 1.327407 4.873481 2.23763 23.665778 0.663704 50.422519-0.739556 12.856889 34.266074 28.501333 52.375704 97.071407C828.434963 628.754963 810.30637 661.105778 801.261037 668.86163z" fill="#68A5E1" p-id="1454"></path></svg>
  </a>
  <a href="https://t.me/share/url?url=&text=" class="telegram">
    <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M679.424 746.861714l84.004571-395.995428c7.424-34.852571-12.580571-48.566857-35.437714-40.009143l-493.714286 190.281143c-33.718857 13.129143-33.133714 32-5.705142 40.557714l126.281142 39.424 293.156572-184.576c13.714286-9.142857 26.294857-3.986286 16.018286 5.156571l-237.129143 214.272-9.142857 130.304c13.129143 0 18.870857-5.705143 25.709714-12.580571l61.696-59.428571 128 94.281142c23.442286 13.129143 40.009143 6.290286 46.299428-21.723428zM1024 512c0 282.843429-229.156571 512-512 512S0 794.843429 0 512 229.156571 0 512 0s512 229.156571 512 512z" fill="#1296db" p-id="2441"></path></svg>
  </a>
  <a href="http://service.weibo.com/share/share.php?url=&title=&summary=" class="weibo">
    <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M512 0C229.243259 0 0 229.224296 0 512s229.243259 512 512 512 512-229.224296 512-512S794.756741 0 512 0zM460.8 778.24c-175.312593 0-317.44-91.685926-317.44-204.781037 0-113.095111 212.859259-291.688296 294.286222-291.688296 34.133333 0 101.148444 25.448296 54.272 106.078815-3.280593 5.632 105.718519-46.895407 165.300148-12.344889 59.600593 34.550519 0 90.055111 0 96.218074 0 6.162963 119.656296 6.162963 119.656296 101.717333C776.874667 686.554074 636.112593 778.24 460.8 778.24zM710.276741 359.461926c-19.740444-23.438222-55.030519-17.957926-55.030519-17.957926-10.334815 0.094815-18.375111-7.111111-19.797333-16.839111-0.132741 0.986074-0.568889 1.896296-0.568889 2.901333l0-5.707852c0 1.005037 0.436148 1.85837 0.568889 2.806519 1.422222-9.993481 9.53837-18.792296 19.740444-20.138667 0 0 42.723556-11.681185 79.739259 21.636741 37.015704 33.317926 21.864296 88.405333 21.864296 88.405333-1.592889 11.207111-12.553481 20.15763-23.931259 20.15763L730.832593 434.725926c-11.396741 0-18.033778-8.779852-14.904889-19.607704C715.927704 415.099259 729.998222 382.900148 710.276741 359.461926zM850.62163 430.26963c-1.422222 15.587556-15.018667 28.273778-30.511407 30.01837 1.137778 0.132741 2.23763 0.341333 3.432296 0.341333l-6.97837 0c1.194667 0 2.37037-0.208593 3.546074-0.341333-15.018667-1.744593-25.125926-14.449778-22.945185-30.056296 0 0 16.70637-64.606815-23.988148-123.031704-40.713481-58.424889-128.208593-48.336593-128.208593-48.336593-15.54963-0.018963-28.596148-11.45363-30.245926-26.718815-0.113778 1.080889-0.32237 2.123852-0.32237 3.223704l0-6.409481c0 1.099852 0.208593 2.123852 0.32237 3.185778 1.649778-15.265185 14.506667-27.439407 30.340741-27.553185 0 0 91.098074-9.197037 158.947556 54.954667C871.860148 323.678815 850.62163 430.26963 850.62163 430.26963z" fill="#F56467" p-id="6191"></path><path d="M450.56 573.44m-20.48 0a1.08 1.08 0 1 0 40.96 0 1.08 1.08 0 1 0-40.96 0Z" fill="#F56467" p-id="6192"></path><path d="M403.303951 640.642444a1.62 2.159 0 1 0-25.964544-55.683072 1.62 2.159 0 1 0 25.964544 55.683072Z" fill="#F56467" p-id="6193"></path><path d="M432.033185 451.830519c-111.995259 15.739259-194.484148 87.514074-184.263111 160.331852 10.221037 72.817778 109.321481 119.087407 221.335704 103.329185 112.014222-15.739259 194.503111-87.514074 184.282074-160.331852C643.147852 482.360889 544.047407 436.091259 432.033185 451.830519zM448.398222 695.675259c-66.635852 12.951704-129.384296-21.560889-140.174222-77.065481-10.789926-55.523556 34.474667-111.009185 101.091556-123.960889 66.635852-12.970667 129.384296 21.541926 140.174222 77.065481C560.260741 627.218963 515.015111 682.723556 448.398222 695.675259z" fill="#F56467" p-id="6194"></path></svg>
  </a>
</div>
</div>

    <div class="card comments">
        
    </div>
</article>

    
</main>

</body>
</html>
